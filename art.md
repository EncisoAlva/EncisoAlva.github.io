---
title: Cycloids
feature_image: "https://github.com/EncisoAlva/EncisoAlva.github.io/blob/main/img/banner_tulip.jpg?raw=true"
---

As a hobby I have been making figures that can be described as [epicycloids](https://en.wikipedia.org/wiki/Epicycloid) over [Bezier curves](https://en.wikipedia.org/wiki/B%C3%A9zier_curve), or also as [spirograph curves](https://en.wikipedia.org/wiki/Spirograph) over Bezier curves.
A great collection of those can be found on my Instagram page [BezierSpirographsEveryDay](https://www.instagram.com/bezierspirographseveryday?igsh=MWR2NXBtcGdhNWxyNg==).

~Include figure from instagram~

I keep the code that produces those animations at a public GitHub repository, available in [this link](https://github.com/EncisoAlva/spirographs_matlab). After reading the basic principles, the interested reader may find a more efficient way to implement them. 

Aside from being visually pleasing, these figures are beautiful because they generalize the concept of cycloids.
Many properties of classic cycloids, like the astounding looks, are translated verbatim. 
Other properties, like the simple formulation, are more elusive.

# What are cycloids, epicycloids, hypercycloids?

Classical epicycloids can be described as curves generated by a point $M$, located in a circle $\mathcal{W}$ of radius $R_\mathcal{W}$, which changes position as $\mathcal{W}$ rotates over a circle $\mathcal{C}$ of radius $R_\mathcal{W}$. Let $R_\mathcal{M}$ be the distance between $P$ and the center of $\mathcal{W}$, but for now consider $R_\mathcal{M}=R_\mathcal{W}$. For an epicycloid, $\mathcal{W}$ must be outside of $\mathcal{C}$.

One thing we can observe is that if the ratio $k = R_\mathcal{W}/R_\mathcal{C}$ is an integer, then we obtain a figure with exactly $k$ **petals**.

(Fig 1)

The case when $k = R_\mathcal{W}/R_\mathcal{C} = a/b$ is a rational number becomes a bit more complicated. The number of petals will be $a*\beta$, where $\beta$ is the smallest integer such that $a \beta = 0 $ mod $b$. Also, the petals will intersect.

(Fig 3)

As a spoiler, this quality is conserved when replacing the circle $\mathcal{W}$ with a closed smooth curve $\mathcal{B}$. The number and distribution of petals is determined by the ratio between perimeters $k= perim\left(\mathcal{W}\right) = perim\left(\mathcal{B}\right)$.

(Fig 2)

A similar condition holds for classical hypercycloids, which are defined similarly but using $\mathcal{W}$ inside $\mathcal{C}$.

(Fig 4)

As a spoiler, again, this quality is conserved in general curves. However, general curves may lead to the cycloids that self-intersect --something that doesn't occur for circles.

(Fig 5)

## Modeling of cycloids

The fastest way to parametrize a cycloid is by the angular displacement of $\mathcal{W}$, let it be $\theta$. Recall that the radius of $\mathcal{W}$ is $R_\mathcal{M}$, and the distance from the marker $M$ to the center of $\mathcal{W}$ is $R_\mathcal{M}$.

The coordinates $(u,v)$ of the marker $M$ are given by

$$ \begin{aligned}
u(\theta) &= R_\mathcal{W} \theta - \sin (\theta) \\v(\theta) &= R_\mathcal{W} - \cos (\theta) 
\end{aligned}$$

Now it is a good time to mention curtate cycloids, which occur when $R_\mathcal{M} < R_\mathcal{W}$. On a similar way, a prolate cycloid occur when $R_\mathcal{M} > R_\mathcal{W}$.

(Fig 6)

The terms curtate and prolate can also be applied to hypercycloids.

# What are Bezier curves ?

Bezier curves are parametric curves. Their general definition can be found elsewhere, like in their [Wikipedia page](https://en.wikipedia.org/wiki/B%C3%A9zier_curve). I want to emphasize the case of cubic Bezier curves in the plane. Given the points $P_0, P_1, P_2, P_3$ and a parameter $t \in [0,1]$, the cubic Bezier curve is the collection of points $B(t)$ given by

$$
B(t) = (1-t)^3 P_0 + 3(1-t)^2t P_1 + 3(1-t) t^2 P_2 + t^3 P_3
$$

(Fig?)

Although many things can be said about Bezier curves, I want to emphasize their role on graphic design. The concatenation of multiple cubic Bezier curves, which is called a path, is versatile enough to be used for general-purpose vector graphics. Standard formats such as SVG and EPS use cubic Bezier curves to encode complex general shapes.

Cubic Bezier curves are so common within the graphic design community, intuitive to generate and interpret, and posses a simple formulation. Thus, they are a good way to encode general shapes, in order to construct cycloids over them.

# Cycloids over a Bezier curve

Maybe the most straightforward way to attack this task is by generating a local coordinate system near the curve. An unit tangent vector $T(t)$ can be computed with relative ease.

$$
T(t) = rotate \frac{\frac{d}{dt}B(t)}{\Vert \frac{d}{dt}B(t) \Vert}
$$

Notice that an analytic expression of $T(t)$ is quite challenging, yet it is easy to compute for any given $t$. If the curve is smooth enough, which is often the case, then $(B(t),T(t))$ are good enough to construct map from the plane. 

Recall that the coordinates of the cycloid, paraamterized by $\theta$, are given by
$$ \begin{aligned}
u(\theta) &= R_\mathcal{W} \theta - \sin (\theta) \\v(\theta) &= R_\mathcal{W} - \cos (\theta) 
\end{aligned}$$

Then the coordinates after mapping will be given by
$$ [x,y]^T = 
B(u(\theta)/P_\mathcal{B}) + v(\theta) T(u(\theta)/P_\mathcal{B})
$$

Where $P_\mathcal{B}$, the perimeter of the curve, is given by

$$
\int_0^1 \sqrt{ \left( \frac{d}{dt} B_x(t) \right)^2 + \left( \frac{d}{dt} B_y(t) \right)^2 } dt
$$

where $B_x(t)$ and $B_y(t)$ are the $x,y$ coordinates of $B(t)$, respectively. Notice that, in general, $P_\mathcal{B}$ is difficult to evaluate analytically but easy to approximate numerically.

(Fig final)

The following figure is kept so I don't forget the syntaxis to include figures. Sorry.
![Inverse problem of Electric Source Imaging, simplified.](https://github.com/EncisoAlva/EncisoAlva.github.io/blob/main/img/InverseProblemESI.png?raw=true)