---
title: Cycloids and B'ezier curves
feature_image: "https://github.com/EncisoAlva/EncisoAlva.github.io/blob/main/img/banner_tulip.jpg?raw=true"
---

As a hobby, I have been making figures that can be described as [cycloids](https://en.wikipedia.org/wiki/Cycloid) over [B'ezier curves](https://en.wikipedia.org/wiki/B%C3%A9zier_curve) or as [spirograph curves](https://en.wikipedia.org/wiki/Spirograph) over B'ezier curves.
A great collection of those figures can be found on my Instagram page, [B'ezierSpirographsEveryDay](https://www.instagram.com/B'ezierspirographseveryday?igsh=MWR2NXBtcGdhNWxyNg==).

![Spirograph over the letter J.](https://github.com/EncisoAlva/EncisoAlva.github.io/blob/main/img/art/doubledouble250921_21.png?raw=true)

Aside from being visually pleasing, there is beauty in how these figures generalize the concept of cycloids.

I keep the code to produce those animations at [this](https://github.com/EncisoAlva/spirographs_matlab) public GitHub repository. After learning the basic principles, however, the interested reader may find a more efficient way to implement them. 

# Cycloids, epicycloids, hypercycloids, and their cusps

A **cycloid** can be described as the curves generated by a point $\mathbf{M}$, located in a circle $\mathcal{W}$ of radius $R_\mathcal{W}$, which changes position as $\mathcal{W}$ rotates over a line $\mathcal{L}$. 

![Construction of a cycloid.](https://github.com/EncisoAlva/EncisoAlva.github.io/blob/main/img/art/fig02.png?raw=true)

If the $\mathcal{L}$ is replaced by a circle $\mathcal{C}$ of radius $R_\mathcal{C}$, and $\mathcal{W}$ is outside of $\mathcal{C}$, then the resulting curve will be an **epicycloid**.

If the ratio $k = R_\mathcal{C}/R_\mathcal{W}$ is an integer, then the epicycloid has exactly $k$ *cusps*.

![Epicycloids with integer ratios.](https://github.com/EncisoAlva/EncisoAlva.github.io/blob/main/img/art/fig03.png?raw=true)

If the ratio $k = R_\mathcal{W}/R_\mathcal{C}$ is rational, then the number of cusps will be $\tau$, the smallest integer so that $\tau/k$ is an integer. The curve will self-intersect, leading to a grid-like pattern.

![Epicycloids with rational ratios.](https://github.com/EncisoAlva/EncisoAlva.github.io/blob/main/img/art/fig04.png?raw=true)

If the ratio $k = R_\mathcal{W}/R_\mathcal{C}$ is irrational, then the epicycloid should be dense in a circular donut; the center will be the same as $\mathcal{C}$, the inner radius $R_\mathcal{C}$, and the outer radius $R_\mathcal{C} + 2 R_\mathcal{W} = (1+2k) R_\mathcal{C}$. This case is not very visually pleasing.

*Spoiler:* All these theoretical considerations are conserved if the circle $\mathcal{C}$ is replaced by $\mathcal{B}$, an arbitrary once-differentiable closed curve of finite length.
Although we shall use the ratio between perimeters $k = P_\mathcal{W}/P_\mathcal{B}$.

![Generalized epicycloids with rationl ratios.](https://github.com/EncisoAlva/EncisoAlva.github.io/blob/main/img/art/fig05.png?raw=true)

**Hypercycloids** can be defined in a similar way to epicycloids. The only difference is that the circle $\mathcal{W}$ will be inside $\mathcal{C}$, not outside. All the theoretical considerations about cusps are equally valid for hypercycloids.

![Hypercycloids with rational ratios.](https://github.com/EncisoAlva/EncisoAlva.github.io/blob/main/img/art/fig06.png?raw=true)

## Parametrization of cycloids

The fastest way to parametrize a cycloid is by the angular displacement of $\mathcal{W}$, let it be $\theta$. Recall that the radius of $\mathcal{W}$ is $R_\mathcal{M}$, and the distance from the marker $M$ to the center of $\mathcal{W}$ is $R_\mathcal{M}$.

The coordinates $(u,v)$ of the marker $M$ are given by

$$ \begin{aligned}
u(\theta) &= R_\mathcal{W} \theta - \sin (\theta) \\v(\theta) &= R_\mathcal{W} - \cos (\theta) 
\end{aligned}$$

Now it is a good time to mention curtate cycloids, which occur when $R_\mathcal{M} < R_\mathcal{W}$. In a similar way, a prolate cycloid occurs when $R_\mathcal{M} > R_\mathcal{W}$.

(Fig 6)

The terms curtate and prolate can also be applied to hypercycloids.

# What are B'ezier curves?

B'ezier curves are parametric curves. Their general definition can be found elsewhere, like in their [Wikipedia page](https://en.wikipedia.org/wiki/B%C3%A9zier_curve). I want to emphasize the case of cubic B'ezier curves in the plane. Given the points $P_0, P_1, P_2, P_3$ and a parameter $t \in [0,1]$, the cubic B'ezier curve is the collection of points $B(t)$ given by

$$
B(t) = (1-t)^3 P_0 + 3(1-t)^2t P_1 + 3(1-t) t^2 P_2 + t^3 P_3
$$

(Fig?)

Although many things can be said about B'ezier curves, I want to emphasize their role on graphic design. The concatenation of multiple cubic B'ezier curves, which is called a path, is versatile enough to be used for general-purpose vector graphics. Standard formats such as SVG and EPS use cubic B'ezier curves to encode complex general shapes.

Cubic B'ezier curves are so common within the graphic design community. They are intuitive to generate and interpret, and have a simple formulation. Thus, they are a good way to encode general shapes and construct cycloids over them.

# Cycloids over a B'ezier curve

Maybe the most straightforward way to attack this task is by generating a local coordinate system near the curve. An unit tangent vector $T(t)$ can be computed with relative ease.

$$
T(t) = rotate \frac{\frac{d}{dt}B(t)}{\Vert \frac{d}{dt}B(t) \Vert}
$$

Notice that an analytic expression of $T(t)$ is quite challenging, yet it is easy to compute for any given $t$. If the curve is smooth enough, which is often the case, then $(B(t),T(t))$ is good enough to construct a map from the plane. 

Recall that the coordinates of the cycloid, parameterized by $\theta$, are given by
$$ \begin{aligned}
u(\theta) &= R_\mathcal{W} \theta - \sin (\theta) \\v(\theta) &= R_\mathcal{W} - \cos (\theta) 
\end{aligned}$$

Although it is tempting to map $\theta$ into $B(t)$, we shall consider that $B(t)$ does not necessarily go over its trace at constant speed. In other words, we can measure the traversed path of $B(t)$ from $0$ to $t$ as follows

$$
A(t) = \int_0^t \sqrt{ \left( \frac{d}{ds} B_x(s) \right)^2 + \left( \frac{d}{ds} B_y(s) \right)^2 } ds
$$
where $B_x(t)$ and $B_y(t)$ are the $x,y$ coordinates of $B(t)$, respectively. 

The function $A(t)$ is not necessarily linear, yet it needs to be accounted for when mapping $\theta$ into $B(t)$.
The simplest way to write the coordinates after mapping will be given by
$$ [x,y]^T = 
B\left( u\left(A^{-1}\left(\theta\right)\right)\right) + v\left(A^{-1}\left(\theta\right)\right) T\left( u\left(A^{-1}\left(\theta\right)\right)\right)
$$

In general, the function $A$ may not have a simple closed-form; however, it can be approximated with relative ease. 
Similarly, $A^{-1}$ will be troublesome to write analytically. 

The use of $A^{-1}$ can be avoided by using the following strategy:
1. Generate a collection of values $t \in [0,1]$.
2. Compute $\theta(t) = A(t)$.
3. Compute $u(t)= R_\mathcal{W} \theta(t) - \sin (\theta(t))$, $v(t) = R_\mathcal{W} - \cos (\theta(t))$.
4. Compute $[x(t), y(t)]^T = B\left( u\left(t\right)\right) + v\left(t\right) T\left( u\left(t\right)\right)$.

(Fig final)

# Discussion

The construction of generalized epi- and hypercycloids over general curves brings implies a collection of physical constraints that are unnacounted for. If a physically feasible construction is desired, they can be identified and removed manually.

When constructing generalized hypercycloids using a curve $\mathcal{B}$, a **return effect** is generated when the curvature of $\mathcal{B}$ is smaller than the curvature of $\mathcal{W}$. This behavior is not physically feasible. This condition represents the case when $\mathcal{W}$ *doesn't fit* in a section of $\mathcal{B}$. 

![Generalized hypercycloids with rational ratios.](https://github.com/EncisoAlva/EncisoAlva.github.io/blob/main/img/art/fig07.png?raw=true)

# Future work

Words more, words less. The algorithm can be easily generalized for other rolling shapes. Just change the parametrization for $(u,v)$. But general shapes will bring new sets of physical constraints that need to be incorporated to the model.