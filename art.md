---
title: Cycloids and Bézier curves
feature_image: "https://github.com/EncisoAlva/EncisoAlva.github.io/blob/main/img/banner_tulip.jpg?raw=true"
---

As a hobby, I have been making figures that can be described as [cycloids](https://en.wikipedia.org/wiki/Cycloid) over [Bézier curves](https://en.wikipedia.org/wiki/B%C3%A9zier_curve) or as [spirograph curves](https://en.wikipedia.org/wiki/Spirograph) over Bézier curves.
A great collection of those figures can be found on my Instagram page, [BézierSpirographsEveryDay](https://www.instagram.com/Bézierspirographseveryday?igsh=MWR2NXBtcGdhNWxyNg==).

![Spirograph over the letter J.](https://github.com/EncisoAlva/EncisoAlva.github.io/blob/main/img/art/doubledouble250921_21.png?raw=true)

Aside from being visually pleasing, there is beauty in how these figures generalize the concept of cycloids.

I keep the code to produce those animations at [this](https://github.com/EncisoAlva/spirographs_matlab) public GitHub repository. After learning the basic principles, however, the interested reader may find a more efficient way to implement them. 

# Cycloids, epicycloids, hypercycloids, and their cusps

Consider a circle $\mathcal{W}$ with center at $O_\mathcal{W}$ and radius $R_\mathcal{W}$. The circle $\mathcal{W}$ is *rolling* over a line $R_\mathcal{L}$. A **cycloid** can be described as the curves generated by a point $\mathbf{M}$ located at the circumference of $\mathcal{W}$. 

![Construction of a cycloid.](https://github.com/EncisoAlva/EncisoAlva.github.io/blob/main/img/art/fig02.png?raw=true)

Consider now a similar construction replacing $\mathcal{L}$ with a circle $\mathcal{C}$, with center $O_\mathcal{C}$ and radius $R_\mathcal{C}$.
An **epicycloid** is the curve generated by $\mathbf{M}$.

If the ratio $k = R_\mathcal{C}/R_\mathcal{W}$ is an integer, then the epicycloid has exactly $k$ *cusps*.

![Epicycloids with integer ratios.](https://github.com/EncisoAlva/EncisoAlva.github.io/blob/main/img/art/fig03.png?raw=true)

If the ratio $k = R_\mathcal{W}/R_\mathcal{C}$ is rational, then the number of cusps will be $\tau$, the smallest integer so that $\tau/k$ is an integer. The curve will self-intersect, leading to a grid-like pattern.

![Epicycloids with rational ratios.](https://github.com/EncisoAlva/EncisoAlva.github.io/blob/main/img/art/fig04.png?raw=true)

If the ratio $k = R_\mathcal{W}/R_\mathcal{C}$ is irrational, then the epicycloid should be dense in a circular donut; the center will be the same as $\mathcal{C}$, the inner radius $R_\mathcal{C}$, and the outer radius $R_\mathcal{C} + 2 R_\mathcal{W}$. This case is not very visually pleasing.

*Spoiler:* All these observations about cusps are conserved if the circle $\mathcal{C}$ is replaced by $\mathcal{B}$, an arbitrary once-differentiable closed curve of finite length.
Although we shall use instead the ratio between perimeters $k = P_\mathcal{W}/P_\mathcal{B}$.

![Generalized epicycloids with rationl ratios.](https://github.com/EncisoAlva/EncisoAlva.github.io/blob/main/img/art/fig05.png?raw=true)

**Hypercycloids** can be defined in a similar way to epicycloids. The only difference is that the circle $\mathcal{W}$ will be inside $\mathcal{C}$, not outside. All the theoretical considerations about cusps are equally valid for hypercycloids.

![Hypercycloids with rational ratios.](https://github.com/EncisoAlva/EncisoAlva.github.io/blob/main/img/art/fig06.png?raw=true)

## Parametrization of cycloids and other trochoids

Maybe the simplest way to parametrize a cycloid is in terms of $\theta$, the angular displacement of $\mathcal{W}$. Recall that $\mathcal{W}$ has center $O_\mathcal{W}$ and radius $\mathcal{W}$ is $R_\mathcal{M}$, and let $R_\mathcal{M}$ be the distance from $\mathbf{M}$ to $O_\mathcal{W}$.

$$
\mathbf{M}(\theta)
=
\begin{bmatrix} R_\mathcal{W} \theta - R_\mathcal{M}\sin (\theta) \\ R_\mathcal{W} - R_\mathcal{M} \cos (\theta) \end{bmatrix}
$$

The reason to introduce $R_\mathcal{M}$ is to allow cases when $R_\mathcal{M} \neq R_\mathcal{W}$.
If $R_\mathcal{M} < R_\mathcal{W}$, the resulting curve is known as a **curtate cycloid**. If $R_\mathcal{M} > R_\mathcal{W}$, the resulting curve is known as a **prolate cycloid**.

![Curtate and prolate cycloids.](https://github.com/EncisoAlva/EncisoAlva.github.io/blob/main/img/art/fig07b.png?raw=true)

The term **trochoids** refers to all cycloids, curtate cycloids, and prolate cycloids. The adjectives 'prolate' and 'curtate' can be applied to epi- and hypercycloids by considering $R_\mathcal{M}$on a similar way.

# Bézier curves and their tangent/normal vectors

Many things can be said about Bézier curves; for instance, look at their [Wikipedia page](https://en.wikipedia.org/wiki/B%C3%A9zier_curve). I would like to emphasize their role in graphic design. The concatenation of multiple Bézier curves, referred to as a **path**, is a standard way of producing and encoding general-purpose curves in vector graphics. Most graphic design software allows users to create, visualize, and modify these curves with relative ease. Yet, their formulation is simple enough to be used in this model.

Given $t\in [0,1]$ and the *control points* $\mathbf{P}_0, \mathbf{P}_1, \mathbf{P}_2, \mathbf{P}_3$, a **cubic Bézier curve** is the collection of $\mathbf{B}(t)$ defined as

$$
\mathbf{B}(t) = (1-t)^3 \mathbf{P}_0 + 3(1-t)^2t \mathbf{P}_1 + 3(1-t) t^2 \mathbf{P}_2 + t^3 \mathbf{P}_3.
$$

![Bezier curve and its control points.](https://github.com/EncisoAlva/EncisoAlva.github.io/blob/main/img/art/fig08.png?raw=true)

For rolling a circle over a cubic Bézier curve, it is convenient to consider a unit normal vector, $\mathbf{N}$, at the contact point. 
One way to construct such a vector is to construct a unit tangent vector, $\mathbf{T}$, and then rotate it.

For a particular value of $t$, the unit tangent vector $\mathbf{T}(t)$ and the unit normal vector $\mathbf{N}(t)$ are given by

$$
\begin{align}
\mathbf{T}(t) &= \frac{\frac{d}{dt}\mathbf{B}(t)}{\Vert \frac{d}{dt}\mathbf{B}(t) \Vert}, \\
\mathbf{N}(t) &= \begin{bmatrix} 0 & 1 \\ -1 & 0 \end{bmatrix} \mathbf{T}(t).
\end{align}
$$

Although it is challenging to obtain a closed-form expression for $\mathbf{T}(t)$ and $\mathbf{N}(t)$, they can be computed easily for any value of $t$. 

With $\mathbf{N}(t)$ at hand, we can, for example, find the center of a circle rolling over the curve based on the fact that the circle must be tangent to the curve at the contact point. 

![Tangent and normal vectors to a Bezier curve, and a contact point with a circle.](https://github.com/EncisoAlva/EncisoAlva.github.io/blob/main/img/art/fig09b.png?raw=true)

# A cycloid over a Bézier curve

Consider a circle $\mathcal{W}$, with center $O_\mathcal{W}$ and radius $R_\mathcal{W}$, with a marker point $\mathbf{M}$ at distance $R_\mathcal{M}$ from $O_\mathcal{W}$.
Consider that $\mathcal{W}$ is rolling over a Bezier curve $\mathcal{B}$ with *control points* $\mathbf{P}_0, \mathbf{P}_1, \mathbf{P}_2, \mathbf{P}_3$.

Previously, it was shown how to parametrize a cycloid in terms of the angular displacement $\theta$. Also, it was shown how to parametrize the Bézier curve in terms of a parameter $t$. These parameters should be connected in such a way that the circle and the curve have a common contact point.

In order to keep the interpretation of *a circle running over a curve*, it is convenient to consider the traversed arc. Let $A_\mathcal{W}$ and $A_\mathcal{B}$ the length of arc traversed by a point moving over $\mathcal{W}$ and $\mathcal{B}$, respectively. They can be computed as follows,

$$
\begin{align}
A_\mathcal{W}(\theta) &= R_\mathcal{W} \theta \\
A_\mathcal{B}(t) &= \int_0^t \sqrt{ \left( \frac{d}{ds} \mathbf{B}_x(s) \right)^2 + \left( \frac{d}{ds} \mathbf{B}_y(s) \right)^2 } ds .
\end{align}
$$

where $\mathbf{B}_x$ and $\mathbf{B}_y$ are the $x$ and $y$ components of $\mathbf{B}$, respectively.

![Cumulative arc length over a Bezier curve with standard parametrization.](https://github.com/EncisoAlva/EncisoAlva.github.io/blob/main/img/art/fig10a.png?raw=true)

Now, $t$ and $\theta$ should be parametrized in such a way that $A_\mathcal{W}(\theta) = A_\mathcal{B}(t)$.
The most straightforward way to do so is by setting

$$
\theta(t) = \frac{1}{R_\mathcal{W}} A_\mathcal{B}(t).
$$

The position of the cycloid in terms of $t$ is determined by simple composition,

$$
\mathbf{M}(t) 
=
\begin{bmatrix} R_\mathcal{W} \theta(t) - R_\mathcal{M}\sin \left(\theta\left( t \right)\right) \\ R_\mathcal{W} - R_\mathcal{M} \cos \left(\theta\left( t \right)\right) \end{bmatrix}.
$$

Yet, the position of the cycloid **after** setting it on the curve, $\tilde{\mathbf{M}}$, can be determined using the tangent and normal vectors,

$$
\tilde{\mathbf{M}}(t) = \mathbf{B}(t) + \mathbf{M}_x(t) \mathbf{T}(t) + \mathbf{M}_y(t) \mathbf{N}(t).
$$

![Cycloid over a Bezier curve.](https://github.com/EncisoAlva/EncisoAlva.github.io/blob/main/img/art/fig10.png?raw=true)

Needless to say, this formulation will work for any trochoid over the Bezier curve. However, rolling a circle over a **path** (concatenation of Bezier curves) will require accounting for the cumulative traversed arc over the multiple curves. 

Another factor that must be accounted for in a path is the corners, the connection between one Bézier curve and the next. For the animations in Instagram, this is done depending on the angle formed by the normal.
The cycloids that are cut by a reflex angle are stitched together using a circular arc. 
The acute and obtuse angles are simply replaced by circular arcs.

![Replacements due to corners on a concatenation of Bezier curves.](https://github.com/EncisoAlva/EncisoAlva.github.io/blob/main/img/art/fig13.png?raw=true)


# Discussion

One strength of this small model for a rolling circle is that it does not depend intrinsically on using Bezier curves. In fact, the function $\mathbf{B}$ can be replaced with any other parametric curve that is once-differentiable and has finite length. The motivation to choose Bézier curves in particular comes from their versatility to create complex shapes with relative ease, which can be done with the aid of software.

The construction of generalized epi- and hypercycloids over general curves brings implies a collection of physical constraints that are unnacounted for. If a physically feasible construction is desired, they can be identified and removed manually.

When constructing generalized hypercycloids using a curve $\mathcal{B}$, a **return effect** is generated when the curvature of $\mathcal{B}$ is smaller than the curvature of $\mathcal{W}$. This behavior is not physically feasible. This condition represents the case when $\mathcal{W}$ *doesn't fit* in a section of $\mathcal{B}$. 

![Return effect, described on the text, is related to the curvature radius.](https://github.com/EncisoAlva/EncisoAlva.github.io/blob/main/img/art/fig12.png?raw=true)

This situation can be identified using the **radius of curvature** of the Bezier curve, $\kappa$, which can be computed as

$$
\kappa(t) = \frac{\left[ \left( \frac{d}{dt} \mathbf{B}_x(t) \right)^2 + \left( \frac{d}{dt} \mathbf{B}_y(t) \right)^2 \right]^{3/2}}{\left( \frac{d}{dt} \mathbf{B}_x(t) \right)\left( \frac{d^2}{dt^2} \mathbf{B}_y(t) \right) - \left( \frac{d}{dt} \mathbf{B}_y(t) \right) \left( \frac{d^2}{dt^2} \mathbf{B}_x(t) \right)}.
$$

With this notation at hand, we notice that the *return* effect occurs whenever $\kappa > R_\mathcal{W}$. 
The case $\kappa < 0$ indicates that the radius of curvature is facing the opposite orientation, and so no return effect will be observed regardless of the value of $R_\mathcal{W}$. 

Finally, it is important to acknowledge that this model only accounts for a single rotating circle. With some small changes, the rotating circle $\mathcal{W}$ can be replaced by some non-circle shape.

One remarkable trend for modern spirograph designers is the use of *rings*, circular pieces with circular holes inside them. The marker point rolls at the inner circle of the ring, while the outer circle rolls over a larger circle-like shape. Furthermore, a second ring can be nested inside the first ring. 

Needless to say, the curves produced by nested rings are much more complex than cycloids. By adjusting the ratios between the perimeters of circles involved in this process properly, it is possible to produce a great variety of patterns. 

This modeling strategy may work with nested rings by composing the mapping over the tangent/normal vectors at the contact points.